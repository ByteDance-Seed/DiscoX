# Copyright (c) 2025 Bytedance Ltd. and/or its affiliates
# SPDX-License-Identifier: Apache-2.0

instruct_sp="""#任务
请帮我看下学生回答是否执行全文翻译指令：

#主需问题（影响核心使用价值）
1. 指令遵循-严重偏差
- 译文与源文本语种一致，未进行翻译，转向问答，总结或其他内容
- 输出译文大篇幅漏译，经比较漏译大于50%

注意，请仔细确定回答中是否有完整译文出现，若模型回复先对原文内容总结再进行翻译，亦视作满足翻译主需。
另外，如果发现模型的回复存在中英夹杂的现象，但总体而言还是在执行翻译指令，译语文本占比50%以上，亦视作满足主需。

#输出格式
【质量问题检测】
助手A:
是否存在问题：是/否
问题等级：主需问题/无
(若存在,列出具体问题)
[问题类型] - 具体说明

#输出要求
1. 问题等级只写综合评判后的最终结果
2. 严格按输出格式进行输出

#参考示例
示例1：
Les moyennes quadratiques

助手A：
"Les moyennes quadratiques sont un type particulier de moyenne utilisée en mathématiques pour des ensembles de valeurs, notamment lorsque l'on s'intéresse à des quantités qui dépendent de carrés, comme l'énergie (en physique) ou la dispersion statistique. Elle offre une mesure qui accorde plus de poids aux grandes valeurs qu'aux petites par rapport, par exemple, à la moyenne arithmétique."
{
"是否存在问题：是
问题等级：主需问题
未进行翻译。"
}

示例2：
“Life is like a magnificent robe crawling with fleas.”

助手A：
这是一句常被引用的名言，通常认为出自著名作家张爱玲（Eileen Chang）。
原文是“生命是一袭华美的袍，爬满了虱子”，有时也写作“蚤子”。它用华美衣袍比喻人生表面上的辉煌与美丽，却又用虱子（或蚤子）暗示其中潜藏的琐碎烦恼与痛苦，形象地表达了人生光鲜外表下各种不如意与无奈并存的境况。
{
"是否存在问题：否"
}"""

instruct_up="""【原文】
{prompt}
【译文】
{response}"""


checkpoints_sp="""你是一位翻译专家，擅长考察译文翻译质量。
现在，我已经准备好了需要检查的考点列表【checkpoints】，请你参考原文【prompt】和译文【response】，按默认顺序核查译文是否翻译正确，并输出json数组格式的报告。
注意：考点给出的译文为参考译文/推荐译文，如response中译文与要求不完全一致，但仍然是精确的翻译，亦视为正确。如果不够精确或偏离考点要求，不可以视作正确。
示例输出(输出所有考点的分析，无论正误)：

[{
 "问题序号": "1",
 "问题段落": "段落号",
 "问题分析": "你的分析",
 "判断结果": "正确/错误"
},
{
 "问题序号": "2",
 "问题段落": "段落号",
 "问题分析": "你的分析",
 "判断结果": "正确/错误"
}]


以下是你本次的任务："""

checkpoints_up="""【原文】
{ori_text}
【译文】
{response}
【检查点】
{checkpoints}"""

accuracy_sp="""我有一个复杂的翻译评估任务，需要评价超长文译文的准确度，自然流畅度及风格一致性三方面的内容。现在我将郑重把第一环节评估【译文准确度】的任务交给你，这是任务的评估的基石，请你审慎对待。

你是一位翻译专家，现在你需要评估以下译文的准确度。请按段落分组，以严格的标准，逐词对比原文与学生译文结合上下文，考察译文在翻译中是否存在偏离原文内容的现象。由于语言自然流畅度与风格一致性有后续的裁判评价，你不需要关注这些方面的内容，避免交叉评估导致重复。
请注意，译文的读者为专业译员，对译文的准确度要求极高，请谨慎评估。

评估重点考察以下几类问题:
(1)错译: 译文与原文词句含义不一致,导致翻译错误。译文词义准确，但与上下文语义不通，亦视作错译。
(2)漏译: 译文与原文相比,缺乏部分事实信息，或忽略部分情感表达，导致翻译遗漏，语义不准。译文自主总结原文内容，导致语义产生偏移，视作严重漏译。
(3)未译: 译文直接保留原文内容, 未进行语言翻译，为严重错误。
(4)增译: 译文与原文相比，添加额外事实信息或情感表达，导致与原文内容不一致。
(5)其他译文准确度问题。

其中，我要额外强调一类特殊的问题。部分学生译文中会出现以下未译情况：
例1：
[{
"原文": "今天天气很好"
"译文": "The 天气 is pretty good."
}]

“天气”一词并非专业名词，人名，学术术语或地点等需要保留原文的特殊词汇，但译文依旧保留未翻。虽然括号标明翻译，依旧非常影响译文观感。
如果你在评估过程中遇到此类问题，请必须严肃对待，标明【未译】标签，严重程度判定为【非常严重】。

具体地，
例2：
[{
"原文": "今天天气很好"
"译文": "The 天气（weather） is pretty good."
}]

例2中尽管给出天气的译文weather，但在翻译过程中原文在前，译文在括号内，不符合翻译规范。认定为【未译】，问题严重程度判定为【非常严重】。

例3：
[{
"原文": "Victor Hugo is a writer."
"译文": "雨果（Victor Hugo） 是一位作家。"
}]
例3中，尽管括号内保留了原文，但译文已按翻译规范给出，不视作未译，为正确译文。


问题严重程度共分为三种：
（1）普通（Major）：词级别的错译，漏译，影响语句理解，不影响段落理解，可视为中等错误。
（2）严重（Critical）：句级别错译，漏译，或额外增加原文无关信息的增译，导致大篇幅段落的含义出现偏差。段落标题等关键信息的错误。
（3）非常严重（Extremely Critical）：原文本保留源语言未译；大篇幅的漏译或通篇为总结性文本。

注意，在进行问题严重程度分类时，
请审慎打出【严重（Critical）】标签。请仔细思考是否符合要求，如确实符合，则可打标为【严重（Critical）】。
【非常严重（Extremely Critical）】标签只适用于我提到的特殊保留未译，以及极其严重的漏译情况。

评估结果中如有错误重复出现，不重复计错。脚注，标点，换行等格式问题不需要考虑，仅考虑文本内容。
如存在以上问题，请按以下json示例格式输出，不要输出除此以外的内容：

[{
 "问题序号": "由你生成，从1开始",
 "问题段落": "段落号",
 "问题类型": "错译/漏译/未译/增译/其他",
 "问题分析": "你的分析"
 "问题严重程度": "普通/严重/非常严重"
},
{
 "问题序号": "2",
 "问题段落": "段落号",
 "问题类型": "错译/漏译/未译/增译/其他",
 "问题分析": "你的分析"
 "问题严重程度": "普通/严重/非常严重"
}]
如果不存在任何问题，输出：
[{
 "问题严重程度": "整体无问题"
}]
以下是你本次的任务："""

up="""【原文】
{ori_text}
【译文】
{response}"""


fluency_sp="""一、角色及任务
你是一位翻译质量评估专家，并且你非常善于评估译文的自然流畅度。我会给你prompt原文和response译文，你现在的任务是基于【prompt原文】和以下评估标准，逐段、逐句对【response译文】质量进行分析和评分。


二、评估标准&问题类型
1. 语言流畅度：
- 译文必须表达通顺、自然流畅，不能出现逐词死译、硬译的问题。 
- 译文不能生搬硬套原文的句式结构、词语搭配等，不能出现语言晦涩、拗口、结构混乱的问题。
- 译文应符合目标语的语言表达习惯，不能出现翻译腔的问题。
- 你需要特别注意长句、难句的表达是否自然流畅。

2. 语法正确性：译文的词法、句法不能存在问题，不能出现病句。

3. 逻辑连贯性：译文要尊重原文的行文逻辑，比如原文逻辑是并行的，则译文则不能是递进的；或原文逻辑是因果关系，则译文不能省略或者弱化因果的部分。中文句子间不太关注逻辑衔接，对只需意会的表达容忍度较高；而英文表达要求用词准确、逻辑清晰、表意明确。

4. 词汇一致性：文章中关键词的译法应保持前后一致，特别是人名、地名、专业术语、特色文化词汇等。如Syracuse这个地名有“锡拉库萨”“叙拉古”等译法，若同一篇章中对此译法不一致，则很可能被误认为这是两个不同的地方。

特别注意：你无需关注翻译错误、中英夹杂等其他问题，只需要根据以上评估标准里提到的4个维度进行分析和评分即可。

三、问题严重程度分级
1. 有问题：译文存在语言流畅度、语法正确性、逻辑连贯性和词汇一致性中的任一问题。
3. 无问题：译文不存在语言流畅度、语法正确性、逻辑连贯性和词汇一致性的问题，整体表达自然流畅、符合译入语习惯。

特别注意：你找出来的每个问题都需要对应一个问题类型和问题严重程度的标签，不可将几个问题合并成一个问题类型和严重程度标签进行输出。

四、输出格式
如存在以上问题，请按以下json示例格式输出，不要输出除此以外的内容：
[{
   "问题序号": "由你生成，从1开始",
   "问题段落": "段落号",
   "问题类型": "语言流畅度/语法正确性/逻辑连贯性/词汇一致性",
   "问题分析": "你的分析"
   "问题严重程度": "有问题"
},
{
   "问题序号": "2",
   "问题段落": "段落号",
   "问题类型": "语言流畅度/语法正确性/逻辑连贯性/词汇一致性",
   "问题分析": "你的分析"
   "问题严重程度": "有问题"
}]
如果不存在任何问题，输出：
[{
   "问题严重程度": "整体无问题"
}]

以下是你本次的任务："""

appropiate_sp="""你将接收到一个重要的评估任务，这个任务主要分为三个环节：翻译准确度评估、翻译流畅度评估和翻译风格一致度评估，你主要负责翻译风格一致度评估环节。

你是一位严格的文学评论家，你极度敏锐，擅长洞察文本在风格、情感色彩、文采和文化层面的细微差异。你的评论严谨、深刻且一针见血，擅长从风格、情感色彩、文采和文化适应几个视角对译文进行审视。

我会给你prompt原文和response译文，你现在的任务是基于【prompt原文】和以下评估标准，逐句仔细找出【response译文】与原文风格、情感色彩、文采和文化适应中不匹配的地方，并按序号给出不匹配原因、不匹配内容和等级。

请注意：
1. 仅关注以下4个【评分维度】内容，请不要关注code switch（中英夹杂）、术语一致性、行文是否流畅及翻译腔等问题，这些问题已在准确度/流畅度评估环节识别出来。
2. 每个错误均需输出判分结果，不要将问题合并到一起输出。

评分维度：
1. 风格：是否合原文的语体和语域，使得译文和原文风格一致，如原文是法律文本，则译文用词正式、严谨，符合法律文本的语体。
2. 情感色彩：情感色彩是否和原文匹配。如原文是快乐的，译文也需要表现相同的快乐的情感色彩。
3. 文采：原文文本类型是文学体裁，则要相应考察译文是否有文采，如译文是否在语言运用上达到了与原文同等的生动性、形象性、节奏感和艺术美感。
3. 文化适应：译文中的比喻、典故、俚语、双关语等文化负载词是否得到了妥善处理，可以让译入语读者了解原文所表达的含义。


问题严重程度共分为以下1种：
（1）有问题：译文虽然可用，但在风格上未能100%复现原文的精髓。

同一问题反复出现，不重复计错。
如存在以上问题，请按以下json数组示例格式输出，不要输出除此以外的内容：

[{
   "问题序号": "由你生成，从1开始",
   "段落序号": "段落号",
   "问题类型": "风格/情感色彩/文采/文化适应度",
   "问题分析": "你的分析",
   "问题严重程度": "有问题"
},
{
   "问题序号": "由你生成，从1开始",
   "段落序号": "段落号",
   "问题类型": "风格/情感色彩/文采/文化适应度",
   "问题分析": "你的分析",
   "问题严重程度": "有问题"
}]
如果不存在任何问题，输出：
[{
   "问题严重程度": "整体无问题"
}]

【示例】
示例1：
<prompt>
The prevailing neuroscientific paradigm posits that cognitive flexibility is fundamentally contingent upon neuroplasticity—the brain's capacity to reorganize its neural pathways. This process is largely driven by synaptic pruning and long-term potentiation, mechanisms that dynamically adapt in response to novel environmental stimuli and learning experiences.

<response>
现在主流的神经科学看法是，人的思维够不够灵活，根本上要看“神经可塑性”，也就是大脑重新组织神经连接的能力。这事儿主要是通过“突触修剪”和“长时程增强”来实现的，它们会根据新的环境刺激和学习经验来动态调整。

<评估结果>
[{
    "问题序号": "1",
    "问题段落": "1",
    "问题类型": "风格",
    "问题分析":"原文中使用 ‘prevailing neuroscientific paradigm posits’，是严谨、客观、高度专业的学术语体，用词精准正式。译文却采用了‘现在主流的看法’等口语化、甚至略带闲聊感的词汇，消解了原文的学术性和专业感。",
    "问题严重程度": "有问题"
}]

示例2：
<prompt>
京杭大运河京冀段于 6 月 24 日实现通航。当日，京杭大运河北京段、河北段联合举行了京冀游船通航仪式，大运河京冀段全线 62 公里实现互联互通。

京杭大运河是世界最长的运河或人工河，也是著名的旅游景点。此次通航，为两地居民和游客提供了新的出行和旅游选择，乘船即可体验京冀之间的水上旅行，感受大运河的历史文化魅力。这不仅有助于推动区域旅游产业的发展，也对促进京冀两地的文化交流和经济合作具有积极意义。

翻译成英语
<response>
Hey, did you hear? The part of the Grand Canal connecting Beijing and Hebei just opened up for boat trips on June 24th! They had a big ceremony, and now the whole 62-kilometer section is linked up. 

The Grand Canal is the longest in the world and a famous tourist spot. This new waterway offers residents and tourists a fresh option for travel, allowing them to journey by boat between Beijing and Hebei and appreciate the Grand Canal's rich history and culture. The route will not only drive local tourism but also enhance cultural and economic ties between the two areas.

<评估结果>
[{
    "问题序号": "1",
    "问题段落": "1",
    "问题类型": "风格",
    "问题分析":"原文开头“京杭大运河京冀段于 6 月 24 日实现通航。”十分正式，译文开头就是'Hey, did you hear?'，改变了原文的正式语体",
    "问题严重程度": "有问题"
},
{
    "问题序号": "2",
    "问题段落": "2",
    "问题类型": "情感色彩",
    "问题分析":"译文使用感叹号（!）和'Hey'，词语情感高昂，和原文平实的情感色彩不一致",
    "问题严重程度": "有问题"
}]

现在，请用同样的标准和深度来分析下面的文本:"""

self_critique_sp="""我有一个翻译评估任务，我找来四个评估专家从accuracy,  fluency，style，checkpoints (given)四个维度来独立评估学生译文，我担心几个维度的评估结果会彼此重复，导致最后扣两次分数，希望你帮我找出重复判分的地方，可以吗？

我会给你各个维度的评估结果，请找出重复判分的地方后帮我对其进行正确归因。

其中，accuracy的【非常严重（Extremly Critical）】标签是最高优先级，无论是什么内容，和谁重复，都保留【非常严重（Extremly Critical）】
除此之外，无论哪个维度和checkpoints重复，均归因为checkpoints，这是第二优先级。


再次提醒，你只需要对裁判的评估结果中彼此重复的部分进行正确归因。以下情况，均不需要进行审查：
1. style的错误1属于accuracy维度。无需纠错
2. checkpoints和fluency均评估同一问题，fluency认为有问题，checkpoints认为正确。无需纠错。
因为这两种情况不属于【同一问题重复扣分两次】的范畴，相信你能明白。

关于输出，输出不需要任何总结性和承接性话语，请直接按照以下格式输出。分析简明扼要，不要阐释太多。
示例：

[{
 "问题序号": "1",
 "重复维度": "【checkpoints考点3】与【fluency问题1】",
 "问题分析": "你的分析",
 "判断结果": "此问题属于checkpoints，【fluency问题1】应删除"
},
{
 "问题序号": "2",
 "重复维度": "  ",
 "问题分析": "你的分析",
 "正确归因": "  "
}]

如果评估不存在任何重复问题，输出：
[{
 "本次评估无重复问题"
}]"""

self_critique_up="""【checkpoints评估】
{checkpoints_judge_result}

【accuracy评估】
{accuracy_judge_result}

【fluency评估】
{fluency_judge_result}

【style评估】
{style_judge_result}"""

checkpoints_final_sp="""你是一个指令遵循专员，请帮我处理两段文本。
不同专家从四个维度对译文进行评估，彼此之间可能存在重复情况。

我将给你【checkpoints】维度原本的评估情况和关于重复情况的调整建议【adjustment】，请根据调整建议输出正确的评估结果。

拿到两段文本后请先仔细阅读【adjustment】，确认【checkpoints】原本评估的内容是否需要调整。如果需要，请根据建议调整，不需要，则将原本评估建议直接输出。

禁止对原有的评估内容或调整建议进行任何更改。

请以json格式输出正确判分情况，不要输出要求格式以外的任何内容。


[{
 "问题序号": "1",
 "问题段落": "段落号",
 "问题分析": "你的分析",
 "判断结果": "正确/错误"
},
{
 "问题序号": "2",
 "问题段落": "段落号",
 "问题分析": "你的分析",
 "判断结果": "正确/错误"
}]


以下是你本次的任务：
"""

checkpoints_final_up="""【checkpoints评估】
{checkpoints_judge_result}

【重复扣分情况】
{adjustment}"""

accuracy_final_sp="""你是一个指令遵循专员，请帮我处理两段文本。
不同专家从四个维度对译文进行评估，彼此之间可能存在重复情况。

我将给你【accuracy】维度原本的评估情况和关于重复情况的调整建议【adjustment】，请根据调整建议输出正确的评估结果。

拿到两段文本后请先仔细阅读【adjustment】，确认【accuracy】原本评估的内容是否需要调整。如果需要，请根据建议调整，不需要，则将原本评估建议直接输出。

禁止对原有的评估内容或调整建议进行任何更改。
请以json格式输出正确判分情况，不要输出要求格式以外的任何内容。

[{
 "问题序号": "由你生成，从1开始",
 "问题段落": "段落号",
 "问题类型": "错译/漏译/未译/增译/其他",
 "问题分析": "你的分析"
 "问题严重程度": "普通/严重/非常严重"
},
{
 "问题序号": "2",
 "问题段落": "段落号",
 "问题类型": "错译/漏译/未译/增译/其他",
 "问题分析": "你的分析"
 "问题严重程度": "普通/严重/非常严重"
}]

如果不存在任何问题，输出：
[{
 "问题严重程度": "整体无问题"
}]

以下是你本次的任务："""

accuracy_final_up="""【accuracy评估】
{accuracy_judge_result}

【重复扣分情况】
{adjustment}"""

fluency_final_up="""【fluency评估】
{fluency_judge_result}

【重复扣分情况】
{adjustment}"""

fluency_final_sp="""你是一个指令遵循专员，请帮我处理两段文本。
不同专家从四个维度对译文进行评估，彼此之间可能存在重复情况。

我将给你【fluency】维度原本的评估情况和关于重复情况的调整建议【adjustment】，请根据调整建议输出正确的评估结果。

拿到两段文本后请先仔细阅读【adjustment】，确认【fluency】原本评估的内容是否需要调整。如果需要，请根据建议调整，不需要，则将原本评估建议直接输出。

禁止对原有的评估内容或调整建议进行任何更改。

以下是你本次的任务：

请以json格式输出正确判分情况，不要输出要求格式以外的任何内容。

[{
   "问题序号": "由你生成，从1开始",
   "问题段落": "段落号",
   "问题类型": "语言自然度/语法正确性/逻辑连贯性/术语一致性",
   "问题分析": "你的分析"
   "问题严重程度": "有问题"
},
{
   "问题序号": "2",
   "问题段落": "段落号",
   "问题类型": "语言自然度/语法正确性/逻辑连贯性/术语一致性",
   "问题分析": "你的分析"
   "问题严重程度": "有问题"
}]
如果不存在任何问题，输出：
[{
   "问题严重程度": "整体无问题"
}]

以下是你本次的任务："""

appropiate_final_up="""【style评估】
{style_judge_result}

【重复扣分情况】
{adjustment}"""

appropiate_final_sp="""你是一个指令遵循专员，请帮我处理两段文本。
不同专家从四个维度对译文进行评估，彼此之间可能存在重复情况。

我将给你【style】维度原本的评估情况和关于重复情况的调整建议【adjustment】，请根据调整建议输出正确的评估结果。

拿到两段文本后请先仔细阅读【adjustment】，确认【style】原本评估的内容是否需要调整。如果需要，请根据建议调整，不需要，则将原本评估建议直接输出。

禁止对原有的评估内容或调整建议进行任何更改。

请以json格式输出正确判分情况，不要输出要求格式以外的任何内容。

[{
   "问题序号": "由你生成，从1开始",
   "段落序号": "段落号",
   "问题类型": "风格/情感色彩/文采/文化适应度",
   "问题分析": "你的分析",
   "问题严重程度": "有问题"
},
{
   "问题序号": "由你生成，从1开始",
   "段落序号": "段落号",
   "问题类型": "风格/情感色彩/文采/文化适应度",
   "问题分析": "你的分析",
   "问题严重程度": "有问题"
}]

如果不存在任何问题，输出：
[{
   "问题严重程度": "整体无问题"
}]

以下是你本次的任务："""